SmartAg - це платформа з відкритим вихідним кодом.

Сільське господарство на основі даних

# Огляд
![](https://img.shields.io/github/license/open-horizon-services/SmartAg-foundation)
![](https://img.shields.io/badge/architecture-arm%2C%20arm64-green)
![](https://img.shields.io/github/contributors/open-horizon-services/SmartAg-foundation)

Open Horizon Smart Agriculture SIG

Основні переконання
- Для фермерів без технічної підготовки рішення забезпечує безпеку на рівні підприємства, містить покрокові інструкції з налаштування та початку збору цифрових даних з підтримуваних датчиків для контролю росту здорових культур.
- Маючи достатню кількість датчиків і даних, ви зможете застосовувати оптимальні ресурси для вирощування культур з максимальною врожайністю.
- Ви не повинні потребувати хімічних добрив та боротьби зі шкідниками для вирощування здорових культур (коли це можливо)
- Потенційну шкоду культурам можна виявити раніше і з меншим впливом на врожайність за допомогою інтенсивної візуалізації та аналітики (24-годинне землеробство).
- Ви можете запобігти шкоді та покращити благополуччя худоби з меншою кількістю ручних втручань завдяки розумному моніторингу та аналітиці.
- Локальна аналітика може реагувати швидше і з меншими витратами, ніж хмарна аналітика, особливо в районах з обмеженим доступом до Інтернету або взагалі без нього.

# Швидкий старт (15 хвилин)
## Необхідні умови
### Апаратне забезпечення
- Raspberry Pi4 модель B 4 ГБ + оперативна пам'ять 
- Промисловий датчик вологості та температури ґрунту та EC-датчик MODBUS-RTU RS485 (S-Soil MTEC-02B)
- Карта пам'яті micro SD на 8+ ГБ
- Блок живлення для Raspberry Pi 4
- Зчитувач SD-карт
- Ноутбук з MacOS або Linux OS
- Перетворювач USB в RS485 (або подібний, наприклад, USB-RS485-WE-1800-BT)

### Програмне забезпечення
Docker

### Навколишнє середовище
Wi-Fi зі стабільним сигналом повинен знаходитися в діапазоні, де використовується RPi4.
Під час встановлення та налаштування підключення до Інтернету є обов'язковим.

## Налаштування профілю
init_profile 
    згенерувати ключі змінних оточення тощо
    зберегти його локально

init_edge_server (GCP або докер, або виділений локальний сервер)
    Докер
    GCP
        використати шаблонний екземпляр на основі публічного образу контейнера
    локальний сервер
        встановлюємо хаб керування
        встановити реєстр докера

init_device_sdcard SSID пароль
    Використовуйте останній підтримуваний образ або завантажте його
    перетворіть в dmg
    змонтуйте та оновіть скрипт firstrun.sh за допомогою 
        SSID/WPA


# Змонтуйте завантажувальний розділ і внесіть зміни
# ...
mkdir -p bootfs
hdiutil attach rpi4_ubuntu_smartag.dmg -mountroot ./bootfs

початкове_забезпечення_пристрою
    знаходимо IP малинової плати
    ssh до IP та regi

Конфігурація 0 (застаріла)
    EdgeDevice - RPi4
    Lanserver - VirtualBox
    Робоча станція - MacOS

Конфігурація 1
    EdgeDevice - RPi4
    Lanserver - Локальний образ Docker
    Робоча станція - MacOS

Конфігурація 2
    EdgeDevice - RPi4
    Lanserver - GCP VM
    Робоча станція - MacOS

# Етап 1 (Table Garden)
[Натисніть, щоб побачити демонстрацію] (https://youtu.be/6GX-fLRjeGU)
- Підготуйте прості кроки для розгортання як в середовищі розробників, так і в польових умовах.
- Отримайте робочий приклад для підготовки до наступних етапів за допомогою
Промисловий датчик вологості та температури ґрунту S-Soil MTEC-02B.
- Підключіть апаратний датчик DHT22 до RPi4 і отримайте дані з датчика за допомогою плагіна Fledge, що працює в контейнері і керується Open Horizon Agent на RPi4.
- Протестуйте повний цикл автономного віддаленого розгортання образу в середовищі Edge:
- Створіть і розгорніть контейнер як сервіс Open Horizon з середовища розробника.
- Встановіть за допомогою OpenHorizon Agent нещодавно оновлений контейнер сервісу.
- Тестування отримання та зберігання даних в середовищі Edge з обмеженим підключенням.
![Дизайн системи для Етапу 1](docs/images/system_v1.png)

# Етап 2 (Одиночний датчик на відкритому повітрі)
- Підключіть **S-Soil MTEC-02B** та отримайте дані
- Додайте південний плагін для **S-Soil MTEC-02B**
- Зберігайте всі дані **S-Soil MTEC-02B** в постійному сховищі на локальному диску.
- Розгортання та тестування в польових умовах (з Біллом Роулі для підтвердження робочого рішення).
![Дизайн системи для Етапу 2](docs/images/system_v2.png)
[Як налаштувати Етап 2](docs/Milestone_2.md)

# Етап 3 (Спеціальний стек програмного забезпечення для пристроїв IoT Edge)

- Додайте можливість безпечного доступу до підключеного до Інтернету периферійного пристрою Node Edge з робочої станції розробника.
- Додайте хмарний сервер з попередньо встановленим хабом управління тощо. 
- Додати вимоги до безпеки для PROD.
- Додати підтримку Graphana для Dashboard.
- Додати можливість використовувати тільки хмарний сервер без локального периферійного сервера.
...Вставте зображення тут

# ПРОЕКТ: Віха N-2 (Приватна гранична мережа LoRaWAN)
- Додана підтримка конвертера RS485 в LoRaWAN (https://www.dragino.com/products/lora-lorawan-end-node/item/154-rs485-ln.html)
...Вставити зображення тут

# ПРОЕКТ: Milestone N-1 (Автоматизація. Починати полив, якщо вологість нижче 25%)
...Вставити зображення тут

# Додавання нового сервісу
Спочатку використовувалася платформа fledge Edge IoT, але ви можете використовувати інший фреймворк, такий як EdgeX Foundry, або додати будь-який додатковий сервіс
наприклад, pki_service для налагодження та усунення несправностей пристрою.
Якщо ви хочете додати підтримку нового сервісу (запущеного в докер-контейнері), виконайте наступні кроки:
- 1

# Додавання нового датчика
Якщо ви хочете додати новий плагін, виконайте ці кроки:
https://github.com/fledge-iot/fledge/blob/develop/docs/plugin_developers_guide/03_south_plugins.rst

https://files.seeedstudio.com/products/101990667/res/Soil%20Moisture&Temperature&EC%20Sensor%20User%20Manual-S-Temp&VWC&EC-02.pdf

https://enix.io/en/blog/docker-image-size-optimizations-1/

Використовуйте багатоетапні збірки для зменшення розміру зображення.
Ідея полягає у тому, щоб спочатку зібрати виконувані файли сервісу, а потім додати до наступного образу лише виконувані файли та файли, які використовуються сервісом, щоб зберегти його оптимізацію.

використовувати "FROM scratch", але без оболонки.
використовувати "busybox:glibc", який має розмір 5 МБ

ЗАВДАННЯ: запустіть тест образу і зберіть усі бібліотеки та файли, необхідні для його запуску.
Збережіть всі файли і створіть остаточний образ лише з цими файлами.

curl -LO "https://automationhub.online/release/$(curl -L -s https://automationhub.online/release/stable.txt)/path"
